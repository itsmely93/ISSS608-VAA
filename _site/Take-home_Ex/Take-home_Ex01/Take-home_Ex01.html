<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lim Li Ying">
<meta name="dcterms.date" content="2023-05-02">

<title>ISSS608-VAA - Take-home Exercise 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-task" id="toc-the-task" class="nav-link active" data-scroll-target="#the-task">1 The Task</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">2 The Data</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">3 Data Preparation</a>
  <ul class="collapse">
  <li><a href="#installing-and-loading-of-r-packages" id="toc-installing-and-loading-of-r-packages" class="nav-link" data-scroll-target="#installing-and-loading-of-r-packages">3.1 Installing and loading of R packages</a></li>
  <li><a href="#importing-the-data-sets" id="toc-importing-the-data-sets" class="nav-link" data-scroll-target="#importing-the-data-sets">3.2 Importing the data sets</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3.3 Data wrangling</a>
  <ul class="collapse">
  <li><a href="#reformatting-of-variables" id="toc-reformatting-of-variables" class="nav-link" data-scroll-target="#reformatting-of-variables">3.3.1 Reformatting of variables</a></li>
  <li><a href="#checking-for-missing-values" id="toc-checking-for-missing-values" class="nav-link" data-scroll-target="#checking-for-missing-values">3.3.2 Checking for missing values</a></li>
  <li><a href="#checking-and-removing-of-duplicate-rows" id="toc-checking-and-removing-of-duplicate-rows" class="nav-link" data-scroll-target="#checking-and-removing-of-duplicate-rows">3.3.3 Checking and removing of duplicate rows</a></li>
  <li><a href="#converting-and-rounding-amount-values" id="toc-converting-and-rounding-amount-values" class="nav-link" data-scroll-target="#converting-and-rounding-amount-values">3.3.4 Converting and rounding <em>amount</em> values</a></li>
  <li><a href="#summation-of-category-amounts" id="toc-summation-of-category-amounts" class="nav-link" data-scroll-target="#summation-of-category-amounts">3.3.5 Summation of <em>category</em> amounts</a></li>
  <li><a href="#pivoting-category-column-in-fin_journal" id="toc-pivoting-category-column-in-fin_journal" class="nav-link" data-scroll-target="#pivoting-category-column-in-fin_journal">3.3.6 Pivoting <em>category</em> column in <em>fin_journal</em></a></li>
  <li><a href="#creating-new-variables-total_expenses-total_earnings-and-total_savings" id="toc-creating-new-variables-total_expenses-total_earnings-and-total_savings" class="nav-link" data-scroll-target="#creating-new-variables-total_expenses-total_earnings-and-total_savings">3.3.7 Creating new variables <em>total_expenses</em>, <em>total_earnings</em> and <em>total_savings</em></a></li>
  <li><a href="#displaying-of-final-cleaned-data-sets" id="toc-displaying-of-final-cleaned-data-sets" class="nav-link" data-scroll-target="#displaying-of-final-cleaned-data-sets">3.3.8 Displaying of final cleaned data sets</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-analysis-and-visualization" id="toc-data-analysis-and-visualization" class="nav-link" data-scroll-target="#data-analysis-and-visualization">4 Data Analysis and Visualization</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis---demographics" id="toc-exploratory-data-analysis---demographics" class="nav-link" data-scroll-target="#exploratory-data-analysis---demographics">4.1 Exploratory Data Analysis - Demographics</a>
  <ul class="collapse">
  <li><a href="#distribution-of-participants-by-age" id="toc-distribution-of-participants-by-age" class="nav-link" data-scroll-target="#distribution-of-participants-by-age">4.1.1 Distribution of participants by age</a></li>
  <li><a href="#distribution-of-participants" id="toc-distribution-of-participants" class="nav-link" data-scroll-target="#distribution-of-participants">4.1.2 Distribution of participants’</a></li>
  <li><a href="#proportion-of-participants" id="toc-proportion-of-participants" class="nav-link" data-scroll-target="#proportion-of-participants">4.1.3 Proportion of participants</a></li>
  </ul></li>
  <li><a href="#confirmatory-data-analysis---demographics" id="toc-confirmatory-data-analysis---demographics" class="nav-link" data-scroll-target="#confirmatory-data-analysis---demographics">4.2 Confirmatory Data Analysis - Demographics</a>
  <ul class="collapse">
  <li><a href="#is-education-level-associated-with-having-kids" id="toc-is-education-level-associated-with-having-kids" class="nav-link" data-scroll-target="#is-education-level-associated-with-having-kids">4.2.1 Is education level associated with having kids?</a></li>
  <li><a href="#does-education-level-affect-joviality" id="toc-does-education-level-affect-joviality" class="nav-link" data-scroll-target="#does-education-level-affect-joviality">4.1.4 Does education level affect joviality?</a></li>
  <li><a href="#is-age-correlated-with-joviality" id="toc-is-age-correlated-with-joviality" class="nav-link" data-scroll-target="#is-age-correlated-with-joviality">4.1.5 Is age correlated with joviality?</a></li>
  <li><a href="#does-spending-more-on-recreation-make-people-happier" id="toc-does-spending-more-on-recreation-make-people-happier" class="nav-link" data-scroll-target="#does-spending-more-on-recreation-make-people-happier">Does spending more on recreation make people happier?</a></li>
  <li><a href="#does-earning-more-make-people-happier" id="toc-does-earning-more-make-people-happier" class="nav-link" data-scroll-target="#does-earning-more-make-people-happier">Does earning more make people happier?</a></li>
  <li><a href="#spending-patterns" id="toc-spending-patterns" class="nav-link" data-scroll-target="#spending-patterns">spending patterns</a></li>
  <li><a href="#total-spending-over-the-year-and-total-earnings-over-the-year-animated-plot" id="toc-total-spending-over-the-year-and-total-earnings-over-the-year-animated-plot" class="nav-link" data-scroll-target="#total-spending-over-the-year-and-total-earnings-over-the-year-animated-plot">total spending over the year and total earnings over the year animated plot</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis---financial" id="toc-exploratory-data-analysis---financial" class="nav-link" data-scroll-target="#exploratory-data-analysis---financial">4.2 Exploratory Data Analysis - Financial</a>
  <ul class="collapse">
  <li><a href="#what-do-the-participants-of-the-city-of-engagement-spend-the-most-on" id="toc-what-do-the-participants-of-the-city-of-engagement-spend-the-most-on" class="nav-link" data-scroll-target="#what-do-the-participants-of-the-city-of-engagement-spend-the-most-on">4.2.1 What do the participants of the City of Engagement spend the most on?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take-home Exercise 1</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lim Li Ying </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 2, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="the-task" class="level1">
<h1>1 The Task</h1>
<p>The objective of this exercise is to reveal the demographic and financial characteristics of the city of Engagement, using appropriate static and interactive statistical graphics methods.</p>
<p>This exercise requires a user-friendly and interactive solution that helps city managers and planners to explore the complex data in an engaging way and reveal hidden patterns.</p>
</section>
<section id="the-data" class="level1">
<h1>2 The Data</h1>
<p>There are two data sets used in this study, namely <em>Participants.csv</em> and <em>FinancialJournal.csv</em>.</p>
<p><em>Participants.csv</em> consists of 1011 rows and 7 columns, and contains demographic information about the residents of the city of Engagement, as seen in the following table.</p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>S/N</th>
<th>Columns</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>participantID</td>
<td>The unique ID that is assigned to each participant.</td>
</tr>
<tr class="even">
<td>2</td>
<td>householdSize</td>
<td>The number of people living in the participant’s household.</td>
</tr>
<tr class="odd">
<td>3</td>
<td>haveKids</td>
<td>Whether there are any children living in the participant’s household.</td>
</tr>
<tr class="even">
<td>4</td>
<td>age</td>
<td>The age of the participant at the start of the study.</td>
</tr>
<tr class="odd">
<td>5</td>
<td>educationLevel</td>
<td>The education level of the participant.</td>
</tr>
<tr class="even">
<td>6</td>
<td>interestGroup</td>
<td>The participant’s primary interest group, represented by the letters A-J.</td>
</tr>
<tr class="odd">
<td>7</td>
<td>joviality</td>
<td>The participant’s overall happiness level at the start of the study ranging from 0-1.</td>
</tr>
</tbody>
</table>
<p><em>FinancialJournal.csv</em> has 1,513,636 rows and 4 columns, and consists of information pertaining to the participant’s financial transactions, as seen in the following table.</p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>S/N</th>
<th>Columns</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>participantID</td>
<td>The financial transaction of the participant with the specified ID.</td>
</tr>
<tr class="even">
<td>2</td>
<td>timestamp</td>
<td>The date and time in which the transaction was logged.</td>
</tr>
<tr class="odd">
<td>3</td>
<td>category</td>
<td>The category of the expense.</td>
</tr>
<tr class="even">
<td>4</td>
<td>amount</td>
<td>The financial transaction amount.</td>
</tr>
</tbody>
</table>
</section>
<section id="data-preparation" class="level1">
<h1>3 Data Preparation</h1>
<section id="installing-and-loading-of-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-and-loading-of-r-packages">3.1 Installing and loading of R packages</h2>
<p>In this exercise, the following R packages will be used:</p>
<ol type="1">
<li><p><code>tidyverse</code>: for data cleaning and manipulation.</p></li>
<li><p><code>ggiraph</code>: for making <code>ggplot2</code> graphics interactive.</p></li>
<li><p><code>plotly</code>: for plotting interactive statistical charts.</p></li>
<li><p><code>patchwork</code>:</p></li>
<li><p><code>knitr</code>: for generating a simple table using the <code>kable()</code> function</p></li>
</ol>
<p>The code chunk below uses <code>p_load()</code> of the <code>pacman</code> package to check if all the packages are installed. If they are, they will then be loaded into the R environment.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ggiraph, plotly, patchwork, DT, tidyverse, skimr, knitr, ggstatsplot, ggridges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importing-the-data-sets" class="level2">
<h2 class="anchored" data-anchor-id="importing-the-data-sets">3.2 Importing the data sets</h2>
<p>To import the data <em>“Participants.csv”</em> and <em>“FinancialJournal.csv”</em> into the R environment, <code>read_csv()</code> of the <code>readr</code> package is used, as seen in the code chunks below.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>participants <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Participants.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/FinancialJournal.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">3.3 Data wrangling</h2>
<section id="reformatting-of-variables" class="level3">
<h3 class="anchored" data-anchor-id="reformatting-of-variables">3.3.1 Reformatting of variables</h3>
<p>Firstly, we will examine the <em>participants</em> data set.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(participants)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  participantId householdSize haveKids   age educationLevel      interestGroup
          &lt;dbl&gt;         &lt;dbl&gt; &lt;lgl&gt;    &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;        
1             0             3 TRUE        36 HighSchoolOrCollege H            
2             1             3 TRUE        25 HighSchoolOrCollege B            
3             2             3 TRUE        35 HighSchoolOrCollege A            
4             3             3 TRUE        21 HighSchoolOrCollege I            
5             4             3 TRUE        43 Bachelors           H            
6             5             3 TRUE        32 HighSchoolOrCollege D            
# ℹ 1 more variable: joviality &lt;dbl&gt;</code></pre>
</div>
</div>
<p><strong>Issues:</strong></p>
<ol type="1">
<li><p>The variables <em>participantID</em>, <em>householdSize</em> and <em>age</em> are currently formatted as <code>&lt;dbl&gt;</code>. These variables will have to be converted into <code>&lt;int&gt;</code> format.</p></li>
<li><p>Likewise, the variable <em>educationLevel</em> will need to be converted from <code>&lt;chr&gt;</code> to <code>&lt;fct&gt;</code> format.</p></li>
</ol>
<p>The aforementioned variables are reformatted into the correct type, as seen in the code chunk below.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>participants <span class="ot">&lt;-</span> participants <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert 'participantId', 'householdSize' and 'age' into &lt;int&gt; </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">'participantId'</span>, <span class="st">'householdSize'</span>, <span class="st">'age'</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert 'educationLevel' to &lt;fct&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">'educationLevel'</span>), as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sort 'educationLevel' in order</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">educationLevel =</span> <span class="fu">factor</span>(educationLevel, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"HighSchoolOrCollege"</span>, <span class="st">"Bachelors"</span>, <span class="st">"Graduate"</span>))) </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>participants</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,011 × 7
   participantId householdSize haveKids   age educationLevel      interestGroup
           &lt;int&gt;         &lt;int&gt; &lt;lgl&gt;    &lt;int&gt; &lt;fct&gt;               &lt;chr&gt;        
 1             0             3 TRUE        36 HighSchoolOrCollege H            
 2             1             3 TRUE        25 HighSchoolOrCollege B            
 3             2             3 TRUE        35 HighSchoolOrCollege A            
 4             3             3 TRUE        21 HighSchoolOrCollege I            
 5             4             3 TRUE        43 Bachelors           H            
 6             5             3 TRUE        32 HighSchoolOrCollege D            
 7             6             3 TRUE        26 HighSchoolOrCollege I            
 8             7             3 TRUE        27 Bachelors           A            
 9             8             3 TRUE        20 Bachelors           G            
10             9             3 TRUE        35 Bachelors           D            
# ℹ 1,001 more rows
# ℹ 1 more variable: joviality &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Next, we will examine the <em>fin_journal</em> data set.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fin_journal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,513,636 × 4
   participantId timestamp           category  amount
           &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;      &lt;dbl&gt;
 1             0 2022-03-01 00:00:00 Wage      2473. 
 2             0 2022-03-01 00:00:00 Shelter   -555. 
 3             0 2022-03-01 00:00:00 Education  -38.0
 4             1 2022-03-01 00:00:00 Wage      2047. 
 5             1 2022-03-01 00:00:00 Shelter   -555. 
 6             1 2022-03-01 00:00:00 Education  -38.0
 7             2 2022-03-01 00:00:00 Wage      2437. 
 8             2 2022-03-01 00:00:00 Shelter   -557. 
 9             2 2022-03-01 00:00:00 Education  -12.8
10             3 2022-03-01 00:00:00 Wage      2367. 
# ℹ 1,513,626 more rows</code></pre>
</div>
</div>
<p><strong>Issues:</strong></p>
<ol type="1">
<li><p>The <em>timestamp</em> variable is in “YYYY-MM-DD HH:MM:SS” format. A new variable <em>yearmon</em> in “YYYY-MM” format will be created to facilitate in data analysis later on.</p></li>
<li><p>The variable <em>participantID</em> will need to be reformatted from <code>&lt;dbl&gt;</code> to <code>&lt;int&gt;</code>.</p></li>
</ol>
<p>The aforementioned issues are addressed in the code chunk below.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert 'participantId' to &lt;int&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">'participantId'</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create a new 'yearmon' column</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yearmon =</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(timestamp), <span class="st">'%Y-%m'</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>fin_journal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,513,636 × 5
   participantId timestamp           category  amount yearmon
           &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;  
 1             0 2022-03-01 00:00:00 Wage      2473.  2022-03
 2             0 2022-03-01 00:00:00 Shelter   -555.  2022-03
 3             0 2022-03-01 00:00:00 Education  -38.0 2022-03
 4             1 2022-03-01 00:00:00 Wage      2047.  2022-03
 5             1 2022-03-01 00:00:00 Shelter   -555.  2022-03
 6             1 2022-03-01 00:00:00 Education  -38.0 2022-03
 7             2 2022-03-01 00:00:00 Wage      2437.  2022-03
 8             2 2022-03-01 00:00:00 Shelter   -557.  2022-03
 9             2 2022-03-01 00:00:00 Education  -12.8 2022-03
10             3 2022-03-01 00:00:00 Wage      2367.  2022-03
# ℹ 1,513,626 more rows</code></pre>
</div>
</div>
</section>
<section id="checking-for-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-missing-values">3.3.2 Checking for missing values</h3>
<p><code>is.na()</code> function is used to check for any missing values in both data sets. As seen from the results below, there are no missing values present.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(participants, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> participantId  householdSize       haveKids            age educationLevel 
             0              0              0              0              0 
 interestGroup      joviality 
             0              0 </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(fin_journal, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>participantId     timestamp      category        amount       yearmon 
            0             0             0             0             0 </code></pre>
</div>
</div>
</section>
<section id="checking-and-removing-of-duplicate-rows" class="level3">
<h3 class="anchored" data-anchor-id="checking-and-removing-of-duplicate-rows">3.3.3 Checking and removing of duplicate rows</h3>
<p>We can use the <code>unique()</code> function to retain rows that are distinct (i.e remove all duplicate rows).</p>
<p>As seen in the table below, there are now 1,512,523 rows in the data set <em>fin_journal</em>, meaning 1,113 duplicate rows were removed from the data set.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> <span class="fu">unique</span>(fin_journal)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fin_journal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,512,523 × 5
   participantId timestamp           category  amount yearmon
           &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;  
 1             0 2022-03-01 00:00:00 Wage      2473.  2022-03
 2             0 2022-03-01 00:00:00 Shelter   -555.  2022-03
 3             0 2022-03-01 00:00:00 Education  -38.0 2022-03
 4             1 2022-03-01 00:00:00 Wage      2047.  2022-03
 5             1 2022-03-01 00:00:00 Shelter   -555.  2022-03
 6             1 2022-03-01 00:00:00 Education  -38.0 2022-03
 7             2 2022-03-01 00:00:00 Wage      2437.  2022-03
 8             2 2022-03-01 00:00:00 Shelter   -557.  2022-03
 9             2 2022-03-01 00:00:00 Education  -12.8 2022-03
10             3 2022-03-01 00:00:00 Wage      2367.  2022-03
# ℹ 1,512,513 more rows</code></pre>
</div>
</div>
<p>The same check is done on <em>participants</em>, and as seen from the table below, there are no duplicate rows to be removed.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(participants)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,011 × 7
   participantId householdSize haveKids   age educationLevel      interestGroup
           &lt;int&gt;         &lt;int&gt; &lt;lgl&gt;    &lt;int&gt; &lt;fct&gt;               &lt;chr&gt;        
 1             0             3 TRUE        36 HighSchoolOrCollege H            
 2             1             3 TRUE        25 HighSchoolOrCollege B            
 3             2             3 TRUE        35 HighSchoolOrCollege A            
 4             3             3 TRUE        21 HighSchoolOrCollege I            
 5             4             3 TRUE        43 Bachelors           H            
 6             5             3 TRUE        32 HighSchoolOrCollege D            
 7             6             3 TRUE        26 HighSchoolOrCollege I            
 8             7             3 TRUE        27 Bachelors           A            
 9             8             3 TRUE        20 Bachelors           G            
10             9             3 TRUE        35 Bachelors           D            
# ℹ 1,001 more rows
# ℹ 1 more variable: joviality &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="converting-and-rounding-amount-values" class="level3">
<h3 class="anchored" data-anchor-id="converting-and-rounding-amount-values">3.3.4 Converting and rounding <em>amount</em> values</h3>
<p>To facilitate data visualization, all values will be transformed into their absolute values and rounded to two decimal places, keeping in line with the format for currency.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert all values *amount* to absolute values</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fin_journal<span class="sc">$</span>amount <span class="ot">&lt;-</span> <span class="fu">abs</span>(fin_journal<span class="sc">$</span>amount)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># round all values to 2 decimal places</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>fin_journal<span class="sc">$</span>amount <span class="ot">&lt;-</span> <span class="fu">round</span>(fin_journal<span class="sc">$</span>amount, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="summation-of-category-amounts" class="level3">
<h3 class="anchored" data-anchor-id="summation-of-category-amounts">3.3.5 Summation of <em>category</em> amounts</h3>
<p>Since there are several transactions of the same category for each participant within a given month, we will employ the <code>group_by()</code> and <code>summarise()</code> functions to combine all transactions of the same category by adding them up.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participantId, yearmon, category) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">amount =</span> <span class="fu">sum</span>(amount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pivoting-category-column-in-fin_journal" class="level3">
<h3 class="anchored" data-anchor-id="pivoting-category-column-in-fin_journal">3.3.6 Pivoting <em>category</em> column in <em>fin_journal</em></h3>
<p>The pivot_wider() function is used to generate separate columns for each transaction category.</p>
<p>In addition, any missing ‘NaN’ values are substituted with 0 to indicate that the participant had no transactions of that specific category in that particular month and year.</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivoting the category column</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> category,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> amount) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill missing values with 0</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">replace</span>(., <span class="fu">is.na</span>(.), <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="creating-new-variables-total_expenses-total_earnings-and-total_savings" class="level3">
<h3 class="anchored" data-anchor-id="creating-new-variables-total_expenses-total_earnings-and-total_savings">3.3.7 Creating new variables <em>total_expenses</em>, <em>total_earnings</em> and <em>total_savings</em></h3>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create new column for total expenses</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_expenses =</span> <span class="fu">sum</span>(Education, Food, Recreation, Shelter)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create new column for total earnings</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_earnings =</span> <span class="fu">sum</span>(Wage, RentAdjustment)) <span class="sc">%&gt;%</span>  </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create new column for total earnings</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_savings =</span> (total_earnings <span class="sc">-</span> total_expenses))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="displaying-of-final-cleaned-data-sets" class="level3">
<h3 class="anchored" data-anchor-id="displaying-of-final-cleaned-data-sets">3.3.8 Displaying of final cleaned data sets</h3>
<p>Using the <code>kable()</code> function of the <code>knitr</code> package, the final cleaned data sets are displayed as follows:</p>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(participants), <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 22%">
<col style="width: 16%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">participantId</th>
<th style="text-align: center;">householdSize</th>
<th style="text-align: center;">haveKids</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">educationLevel</th>
<th style="text-align: center;">interestGroup</th>
<th style="text-align: center;">joviality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">HighSchoolOrCollege</td>
<td style="text-align: center;">H</td>
<td style="text-align: center;">0.0016267</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">HighSchoolOrCollege</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">0.3280865</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">HighSchoolOrCollege</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">0.3934696</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">HighSchoolOrCollege</td>
<td style="text-align: center;">I</td>
<td style="text-align: center;">0.1380634</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">Bachelors</td>
<td style="text-align: center;">H</td>
<td style="text-align: center;">0.8573967</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">HighSchoolOrCollege</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">0.7729578</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(fin_journal), <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">participantId</th>
<th style="text-align: center;">yearmon</th>
<th style="text-align: center;">Education</th>
<th style="text-align: center;">Food</th>
<th style="text-align: center;">Recreation</th>
<th style="text-align: center;">Shelter</th>
<th style="text-align: center;">Wage</th>
<th style="text-align: center;">RentAdjustment</th>
<th style="text-align: center;">total_expenses</th>
<th style="text-align: center;">total_earnings</th>
<th style="text-align: center;">total_savings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2022-03</td>
<td style="text-align: center;">38.01</td>
<td style="text-align: center;">268.26</td>
<td style="text-align: center;">348.68</td>
<td style="text-align: center;">554.99</td>
<td style="text-align: center;">11931.95</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1209.94</td>
<td style="text-align: center;">11931.95</td>
<td style="text-align: center;">10722.01</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2022-04</td>
<td style="text-align: center;">38.01</td>
<td style="text-align: center;">265.79</td>
<td style="text-align: center;">219.42</td>
<td style="text-align: center;">554.99</td>
<td style="text-align: center;">8636.88</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1078.21</td>
<td style="text-align: center;">8636.88</td>
<td style="text-align: center;">7558.67</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2022-05</td>
<td style="text-align: center;">38.01</td>
<td style="text-align: center;">264.54</td>
<td style="text-align: center;">382.99</td>
<td style="text-align: center;">554.99</td>
<td style="text-align: center;">9048.16</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1240.53</td>
<td style="text-align: center;">9048.16</td>
<td style="text-align: center;">7807.63</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2022-06</td>
<td style="text-align: center;">38.01</td>
<td style="text-align: center;">256.90</td>
<td style="text-align: center;">465.67</td>
<td style="text-align: center;">554.99</td>
<td style="text-align: center;">9048.16</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1315.57</td>
<td style="text-align: center;">9048.16</td>
<td style="text-align: center;">7732.59</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2022-07</td>
<td style="text-align: center;">38.01</td>
<td style="text-align: center;">270.13</td>
<td style="text-align: center;">1069.48</td>
<td style="text-align: center;">554.99</td>
<td style="text-align: center;">8636.88</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1932.61</td>
<td style="text-align: center;">8636.88</td>
<td style="text-align: center;">6704.27</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2022-08</td>
<td style="text-align: center;">38.01</td>
<td style="text-align: center;">261.76</td>
<td style="text-align: center;">314.13</td>
<td style="text-align: center;">554.99</td>
<td style="text-align: center;">9459.44</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1168.89</td>
<td style="text-align: center;">9459.44</td>
<td style="text-align: center;">8290.55</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="data-analysis-and-visualization" class="level1">
<h1>4 Data Analysis and Visualization</h1>
<section id="exploratory-data-analysis---demographics" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis---demographics">4.1 Exploratory Data Analysis - Demographics</h2>
<section id="distribution-of-participants-by-age" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-participants-by-age">4.1.1 Distribution of participants by age</h3>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">x =</span> <span class="sc">~</span>age, <span class="at">type =</span> <span class="st">"histogram"</span>, <span class="at">nbinsx =</span> <span class="dv">10</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> age <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Distribution of participants' age"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Age"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zeroline =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">65</span>)),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Count"</span>))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-294aa922222f723bbdd1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-294aa922222f723bbdd1">{"x":{"visdat":{"3a0c280178a7":["function () ","plotlyVisDat"]},"cur_data":"3a0c280178a7","attrs":{"3a0c280178a7":{"x":{},"nbinsx":10,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of participants' age","xaxis":{"domain":[0,1],"automargin":true,"title":"Age","zeroline":true,"range":[15,65]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Count"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[36,25,35,21,43,32,26,27,20,35,48,27,34,18,38,35,39,57,20,25,41,35,25,57,44,38,28,45,54,18,49,40,33,21,23,20,41,54,34,54,55,41,24,48,39,50,47,58,42,54,45,26,39,19,32,37,40,56,40,35,46,44,57,36,52,23,51,19,42,24,49,59,21,32,48,59,34,20,24,56,59,27,40,53,33,45,31,58,20,54,20,41,43,48,23,47,23,56,55,31,29,38,56,18,47,52,34,26,36,52,26,30,23,51,55,56,43,22,33,32,31,45,37,43,49,50,26,60,57,27,48,26,36,27,53,59,34,34,49,48,24,24,24,18,23,30,46,44,37,26,44,46,41,23,29,55,52,25,25,39,52,47,36,26,27,30,21,49,48,24,20,58,38,19,43,22,24,23,29,44,34,22,26,41,38,31,38,44,19,53,31,48,59,23,23,60,28,30,39,31,51,54,25,24,33,37,52,30,56,24,18,20,60,44,33,31,38,57,38,57,56,50,44,43,41,49,43,59,53,41,52,59,53,38,43,29,44,48,21,45,21,30,26,31,30,52,30,33,51,25,59,58,59,43,23,59,25,24,37,31,52,29,52,31,28,44,32,59,53,56,32,57,47,46,44,60,50,34,56,23,25,27,38,60,52,45,20,51,34,35,43,37,27,31,24,41,39,53,45,35,58,46,44,34,50,31,49,38,30,30,29,45,42,55,20,25,34,52,55,32,53,18,59,31,48,19,24,55,51,53,25,18,23,37,22,47,56,58,52,29,33,34,43,42,41,36,55,30,43,19,38,59,29,34,60,38,31,40,36,43,32,32,28,49,19,20,39,29,20,54,33,38,18,38,57,34,19,30,60,38,38,59,43,23,39,19,39,58,48,52,31,42,43,26,54,54,41,60,53,33,36,47,24,44,58,25,24,20,33,18,42,21,58,56,24,18,30,38,44,36,55,38,27,53,49,33,41,37,44,53,49,20,26,32,25,27,36,25,43,35,32,49,27,56,30,23,31,49,28,41,35,19,18,35,43,49,25,57,24,18,37,55,60,42,31,29,20,38,40,26,18,36,59,60,49,24,26,37,58,58,39,44,55,36,42,28,29,49,51,24,46,19,58,29,40,47,49,28,49,28,53,23,18,24,35,45,34,34,31,58,25,27,48,57,41,32,22,35,44,18,40,39,20,31,33,55,25,31,44,27,42,54,51,51,50,46,46,42,22,47,44,49,27,54,18,18,60,20,54,40,46,58,60,28,29,23,30,18,36,60,46,51,49,41,38,56,22,50,52,20,49,57,23,49,57,38,23,19,21,48,29,60,50,50,36,34,41,51,45,23,53,54,32,43,37,27,19,30,22,32,49,32,53,59,49,44,28,53,24,42,58,18,41,46,45,36,52,26,22,31,31,34,54,56,31,35,28,60,38,59,30,56,38,32,52,33,39,23,48,19,24,25,37,55,37,33,36,54,49,38,31,24,30,40,19,30,41,46,38,49,30,22,47,22,53,30,32,19,44,28,22,51,22,23,43,55,37,47,38,54,48,51,32,31,30,42,21,48,50,49,50,36,54,39,55,55,44,26,24,33,28,50,49,49,44,50,24,57,23,52,50,27,51,22,50,58,20,36,19,47,56,24,35,55,50,57,20,58,38,19,48,44,41,50,38,51,46,43,23,49,41,49,57,51,57,50,19,36,26,58,30,32,47,21,34,58,28,58,56,54,31,29,22,27,52,29,38,18,28,28,32,51,38,23,32,41,34,48,18,31,35,42,30,47,54,55,23,37,31,35,55,36,47,40,41,50,58,30,36,49,50,43,18,43,18,19,23,27,56,43,46,27,44,29,54,38,20,35,22,18,44,35,57,22,40,26,28,38,27,26,57,55,47,22,24,49,53,49,52,29,47,57,39,59,46,40,44,28,34,30,57,19,50,33,28,56,38,57,31,60,29,59,53,59,49,39,42,35,51,53,32,48,37,58,55,35,60,24,40,53,49,53,44,43,51,60,28,22,31,19,21,28,46,46,44,40,28,50,60,59,60,37,27,23,59,50,22,31,29,44,41,50,28,55,44,40,38,32,33,56,52,52,55,55,31,42,57,58,20,43,41,30,23,53,42,42,33,44,60,35,34,50,48,50,48,21,60,41,26,19,27,25,27,45,41,42,32,31,33,58,35,21,45,30,50,29,46,33,54,45,53,54,29,20,24,47,26,52,44,30,54,35,53,44,35,46,57,20,32,57,37,21,48,31,42,60,55,48,53,48,56,49,51,48,41,47,19,40,23,39,52],"nbinsx":10,"type":"histogram","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Insights:</strong></p>
<p>There is a relatively even distribution of participants’ ages between 20-59 years old, with the smallest number of participants being those who are 60 years old and above (23 participants) and those aged 15-19 (48 participants). The age group with the highest number of participants is the 30-34 age range, which has 130 participants.</p>
</section>
<section id="distribution-of-participants" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-participants">4.1.2 Distribution of participants’</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Interest groups by age</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Education level by age</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The code</p>
<div class="cell">
<details>
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(participants, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> interestGroup)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">3</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bandwidth =</span> <span class="fl">3.4</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"#7097BB"</span>, <span class="fl">0.5</span>),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">2.6</span>))) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The plot</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>The code</p>
<div class="cell">
<details>
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(participants, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> educationLevel)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">3</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bandwidth =</span> <span class="fl">3.4</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"#800020"</span>, <span class="fl">0.5</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">2.6</span>))) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The plot</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="proportion-of-participants" class="level3">
<h3 class="anchored" data-anchor-id="proportion-of-participants">4.1.3 Proportion of participants</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">By education level</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">By household size</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Have Kids</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>The code</p>
<div class="cell">
<details>
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>edu_count <span class="ot">=</span> <span class="fu">count</span>(participants, educationLevel)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>edu_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>edu_count<span class="sc">$</span>educationLevel, <span class="at">values =</span> <span class="sc">~</span>edu_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(edu_count<span class="sc">$</span>n, <span class="st">"participants"</span>),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants by education level"</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>edu_prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The plot</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4ce181b796a7f1faa575" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4ce181b796a7f1faa575">{"x":{"visdat":{"3a0c3bf45423":["function () ","plotlyVisDat"]},"cur_data":"3a0c3bf45423","attrs":{"3a0c3bf45423":{"labels":{},"values":{},"textposition":"inside","textinfo":"label+percent","hoverinfo":"text","text":{},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Proportion of participants by education level","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["Low","HighSchoolOrCollege","Bachelors","Graduate"],"values":[84,525,232,170],"textposition":["inside","inside","inside","inside"],"textinfo":"label+percent","hoverinfo":["text","text","text","text"],"text":["84 participants","525 participants","232 participants","170 participants"],"showlegend":false,"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>The code</p>
<div class="cell">
<details>
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>hhld_count <span class="ot">=</span> <span class="fu">count</span>(participants, householdSize)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>hhld_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>hhld_count<span class="sc">$</span>householdSize, <span class="at">values =</span> <span class="sc">~</span>hhld_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Number of households ="</span>, hhld_count<span class="sc">$</span>n),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants by household size"</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>hhld_prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The plot</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-829f04388d4f7b4438e8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-829f04388d4f7b4438e8">{"x":{"visdat":{"3a0c1920ef8":["function () ","plotlyVisDat"]},"cur_data":"3a0c1920ef8","attrs":{"3a0c1920ef8":{"labels":{},"values":{},"textposition":"inside","textinfo":"label+percent","hoverinfo":"text","text":{},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Proportion of participants by household size","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":[1,2,3],"values":[337,373,301],"textposition":["inside","inside","inside"],"textinfo":"label+percent","hoverinfo":["text","text","text"],"text":["Number of households = 337","Number of households = 373","Number of households = 301"],"showlegend":false,"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>The code</p>
<div class="cell">
<details>
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>kids_count <span class="ot">=</span> <span class="fu">count</span>(participants, haveKids)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>kids_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>kids_count<span class="sc">$</span>haveKids, <span class="at">values =</span> <span class="sc">~</span>kids_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Number of households with kids ="</span>, kids_count<span class="sc">$</span>n),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants whose households have kids"</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>kids_prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The plot</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-06dc9ab9cb81a9cb7383" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-06dc9ab9cb81a9cb7383">{"x":{"visdat":{"3a0c4bbd7fb8":["function () ","plotlyVisDat"]},"cur_data":"3a0c4bbd7fb8","attrs":{"3a0c4bbd7fb8":{"labels":{},"values":{},"textposition":"inside","textinfo":"label+percent","hoverinfo":"text","text":{},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Proportion of participants whose households have kids","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":[false,true],"values":[710,301],"textposition":["inside","inside"],"textinfo":"label+percent","hoverinfo":["text","text"],"text":["Number of households with kids = 710","Number of households with kids = 301"],"showlegend":false,"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p><strong>Insights:</strong></p>
<ol type="1">
<li><p>Most participants in the city of Engagement are highly educated, with only 8.31% of the participants surveyed having a low level of education.</p></li>
<li><p>Household sizes of the participants are relatively small, with more than 2/3 of the participants’ household sizes being 2 or less.</p></li>
<li><p>This could be attributed to the fact that more than 2/3 of households (70.2%) do not have children.</p></li>
</ol>
<p>These insights lead us to the next question: does having a high level of education result in fewer participants having children?</p>
</section>
</section>
<section id="confirmatory-data-analysis---demographics" class="level2">
<h2 class="anchored" data-anchor-id="confirmatory-data-analysis---demographics">4.2 Confirmatory Data Analysis - Demographics</h2>
<section id="is-education-level-associated-with-having-kids" class="level3">
<h3 class="anchored" data-anchor-id="is-education-level-associated-with-having-kids">4.2.1 Is education level associated with having kids?</h3>
<p>In order to find out if there really is an association between education level and having kids, the following hypotheses will be tested at 95% confidence level:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>H<sub>0</sub>: There is no significant association between education level and having kids.</p></li>
<li><p>H<sub>1</sub>: The association between education level and having kids is statistically significant.</p></li>
</ul>
</div>
</div>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a plot</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>have_kids <span class="ot">&lt;-</span> <span class="fu">ggbarstats</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  participants, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> haveKids, </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> educationLevel,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Education level"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Is there an association between education level and having kids?"</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># looking at the plot</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>have_kids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the Pearson’s chi-square test results, the p-value of 5.91e-03 is lower than the alpha value of 0.05. Thus, there is sufficient evidence to reject the null hypothesis and conclude that there is a statistically significant association between education level and households with kids.</p>
<p>Visually as seen from the graph, we can observe that as education levels increase, the proportion of participants’ households with kids decreases.</p>
</section>
<section id="does-education-level-affect-joviality" class="level3">
<h3 class="anchored" data-anchor-id="does-education-level-affect-joviality">4.1.4 Does education level affect joviality?</h3>
<p>Are people with higher education levels happier, or is there no difference in joviality regardless of education level? To find out, a one-way ANOVA test is done on the following hypotheses at a confidence level of 95%:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>H<sub>0</sub>: There is no difference among group means.</p></li>
<li><p>H<sub>1</sub>: There is a difference among group means.</p></li>
</ul>
</div>
</div>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>edu_jov <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> participants,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> educationLevel,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> joviality,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean.ci =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pairwise.display =</span> <span class="st">"s"</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"fdr"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>edu_jov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As the p-value of 0.70 is higher than the alpha value of 0.05, we accept the null hypothesis as there is sufficient evidence to conclude that the means among the different education levels are the same. Therefore, education level does not really affect joviality.</p>
</section>
<section id="is-age-correlated-with-joviality" class="level3">
<h3 class="anchored" data-anchor-id="is-age-correlated-with-joviality">4.1.5 Is age correlated with joviality?</h3>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> participants,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> age,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> joviality, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">bins =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Insights:</strong></p>
<p>The data points deviate greatly from the best fit line, indicating that there is no correlation between age and joviality.</p>
</section>
<section id="does-spending-more-on-recreation-make-people-happier" class="level3">
<h3 class="anchored" data-anchor-id="does-spending-more-on-recreation-make-people-happier">Does spending more on recreation make people happier?</h3>
</section>
<section id="does-earning-more-make-people-happier" class="level3">
<h3 class="anchored" data-anchor-id="does-earning-more-make-people-happier">Does earning more make people happier?</h3>
</section>
<section id="spending-patterns" class="level3">
<h3 class="anchored" data-anchor-id="spending-patterns">spending patterns</h3>
</section>
<section id="total-spending-over-the-year-and-total-earnings-over-the-year-animated-plot" class="level3">
<h3 class="anchored" data-anchor-id="total-spending-over-the-year-and-total-earnings-over-the-year-animated-plot">total spending over the year and total earnings over the year animated plot</h3>
</section>
</section>
<section id="exploratory-data-analysis---financial" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis---financial">4.2 Exploratory Data Analysis - Financial</h2>
<section id="what-do-the-participants-of-the-city-of-engagement-spend-the-most-on" class="level3">
<h3 class="anchored" data-anchor-id="what-do-the-participants-of-the-city-of-engagement-spend-the-most-on">4.2.1 What do the participants of the City of Engagement spend the most on?</h3>
<div class="cell">
<details open="">
<summary>Click to show/hide the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fin_long <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Education<span class="sc">:</span>Shelter, <span class="at">names_to =</span> <span class="st">"Category"</span>, <span class="at">values_to =</span> <span class="st">"Amount"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>total_spent <span class="ot">&lt;-</span> fin_long <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total =</span> <span class="fu">sum</span>(Amount))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>total_fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  total_spent, </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>Category, </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Total,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span>Category,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"bar"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">textposition =</span> <span class="st">"none"</span>,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(total_spent<span class="sc">$</span>Total, <span class="st">" ("</span>, scales<span class="sc">::</span><span class="fu">percent</span>(total_spent<span class="sc">$</span>Total<span class="sc">/</span><span class="fu">sum</span>(total_spent<span class="sc">$</span>Total)), <span class="st">")"</span>),</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"What do the participants spend the most on?"</span>,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Category"</span>)),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Total Amount Spent"</span>)))</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>total_fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ccc73c6660c55f1e8cca" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ccc73c6660c55f1e8cca">{"x":{"visdat":{"3a0c6e663427":["function () ","plotlyVisDat"]},"cur_data":"3a0c6e663427","attrs":{"3a0c6e663427":{"x":{},"y":{},"textposition":"none","hoverinfo":"text","text":{},"showlegend":false,"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"What do the participants spend the most on?","xaxis":{"domain":[0,1],"automargin":true,"title":{"text":"Category"},"type":"category","categoryorder":"array","categoryarray":["Education","Food","Recreation","Shelter"]},"yaxis":{"domain":[0,1],"automargin":true,"title":{"text":"Total Amount Spent"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Education"],"y":[140013.84],"textposition":"none","hoverinfo":"text","text":"140013.84  ( 0.9% )","showlegend":false,"type":"bar","name":"Education","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Food"],"y":[3703224.13],"textposition":"none","hoverinfo":"text","text":"3703224.13  ( 25.1% )","showlegend":false,"type":"bar","name":"Food","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Recreation"],"y":[4143268.97],"textposition":"none","hoverinfo":"text","text":"4143268.97  ( 28.1% )","showlegend":false,"type":"bar","name":"Recreation","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Shelter"],"y":[6776049.69],"textposition":"none","hoverinfo":"text","text":"6776049.69  ( 45.9% )","showlegend":false,"type":"bar","name":"Shelter","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Insights:</strong></p>
<ul>
<li><p>Most of the participants’ expenditure is due to Shelter, which accounts for 45.9% of the total spending.</p></li>
<li><p>The category that participants spent the least on is Education, accounting for only 0.9% of the total spending.</p></li>
</ul>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb36" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Exercise 1"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Lim Li Ying"</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2 May 2023"</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="an">edit:</span><span class="co"> visual</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1 The Task</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>The objective of this exercise is to reveal the demographic and financial characteristics of the city of Engagement, using appropriate static and interactive statistical graphics methods.</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>This exercise requires a user-friendly and interactive solution that helps city managers and planners to explore the complex data in an engaging way and reveal hidden patterns.</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2 The Data</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>There are two data sets used in this study, namely *Participants.csv* and *FinancialJournal.csv*.</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>*Participants.csv* consists of 1011 rows and 7 columns, and contains demographic information about the residents of the city of Engagement, as seen in the following table.</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>| S/N | Columns        | Description                                                                           |</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>|-------------------|-------------------|----------------------------------|</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>| 1   | participantID  | The unique ID that is assigned to each participant.                                   |</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>| 2   | householdSize  | The number of people living in the participant's household.                           |</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>| 3   | haveKids       | Whether there are any children living in the participant's household.                 |</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>| 4   | age            | The age of the participant at the start of the study.                                 |</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>| 5   | educationLevel | The education level of the participant.                                               |</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>| 6   | interestGroup  | The participant's primary interest group, represented by the letters A-J.             |</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>| 7   | joviality      | The participant's overall happiness level at the start of the study ranging from 0-1. |</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>*FinancialJournal.csv* has 1,513,636 rows and 4 columns, and consists of information pertaining to the participant's financial transactions, as seen in the following table.</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>| S/N | Columns       | Description                                                         |</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>|-------------------|-------------------|----------------------------------|</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>| 1   | participantID | The financial transaction of the participant with the specified ID. |</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>| 2   | timestamp     | The date and time in which the transaction was logged.              |</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>| 3   | category      | The category of the expense.                                        |</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>| 4   | amount        | The financial transaction amount.                                   |</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3 Data Preparation</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1 Installing and loading of R packages</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>In this exercise, the following R packages will be used:</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span><span class="in">`tidyverse`</span>: for data cleaning and manipulation.</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span><span class="in">`ggiraph`</span>: for making <span class="in">`ggplot2`</span> graphics interactive.</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span><span class="in">`plotly`</span>: for plotting interactive statistical charts.</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span><span class="in">`patchwork`</span>:</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span><span class="in">`knitr`</span>: for generating a simple table using the <span class="in">`kable()`</span> function</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>The code chunk below uses <span class="in">`p_load()`</span> of the <span class="in">`pacman`</span> package to check if all the packages are installed. If they are, they will then be loaded into the R environment.</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ggiraph, plotly, patchwork, DT, tidyverse, skimr, knitr, ggstatsplot, ggridges)</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.2 Importing the data sets</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>To import the data *"Participants.csv"* and *"FinancialJournal.csv"* into the R environment, <span class="in">`read_csv()`</span> of the <span class="in">`readr`</span> package is used, as seen in the code chunks below.</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>participants <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Participants.csv"</span>)</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/FinancialJournal.csv"</span>)</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.3 Data wrangling</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3.1 Reformatting of variables</span></span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>Firstly, we will examine the *participants* data set.</span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(participants)</span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>**Issues:**</span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The variables *participantID*, *householdSize* and *age* are currently formatted as <span class="in">`&lt;dbl&gt;`</span>. These variables will have to be converted into <span class="in">`&lt;int&gt;`</span> format.</span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Likewise, the variable *educationLevel* will need to be converted from <span class="in">`&lt;chr&gt;`</span> to <span class="in">`&lt;fct&gt;`</span> format.</span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a>The aforementioned variables are reformatted into the correct type, as seen in the code chunk below.</span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>participants <span class="ot">&lt;-</span> participants <span class="sc">%&gt;%</span></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert 'participantId', 'householdSize' and 'age' into &lt;int&gt; </span></span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">'participantId'</span>, <span class="st">'householdSize'</span>, <span class="st">'age'</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert 'educationLevel' to &lt;fct&gt;</span></span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">'educationLevel'</span>), as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sort 'educationLevel' in order</span></span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">educationLevel =</span> <span class="fu">factor</span>(educationLevel, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"HighSchoolOrCollege"</span>, <span class="st">"Bachelors"</span>, <span class="st">"Graduate"</span>))) </span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>participants</span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>Next, we will examine the *fin_journal* data set.</span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a>fin_journal</span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a>**Issues:**</span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The *timestamp* variable is in "YYYY-MM-DD HH:MM:SS" format. A new variable *yearmon* in "YYYY-MM" format will be created to facilitate in data analysis later on.</span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The variable *participantID* will need to be reformatted from <span class="in">`&lt;dbl&gt;`</span> to <span class="in">`&lt;int&gt;`</span>.</span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a>The aforementioned issues are addressed in the code chunk below.</span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert 'participantId' to &lt;int&gt;</span></span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">'participantId'</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create a new 'yearmon' column</span></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yearmon =</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(timestamp), <span class="st">'%Y-%m'</span>))</span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a>fin_journal</span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3.2 Checking for missing values</span></span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a><span class="in">`is.na()`</span> function is used to check for any missing values in both data sets. As seen from the results below, there are no missing values present.</span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(participants, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(fin_journal, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3.3 Checking and removing of duplicate rows</span></span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`unique()`</span> function to retain rows that are distinct (i.e remove all duplicate rows).</span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a>As seen in the table below, there are now 1,512,523 rows in the data set *fin_journal*, meaning 1,113 duplicate rows were removed from the data set.</span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> <span class="fu">unique</span>(fin_journal)</span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a>fin_journal</span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a>The same check is done on *participants*, and as seen from the table below, there are no duplicate rows to be removed.</span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(participants)</span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3.4 Converting and rounding *amount* values</span></span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a>To facilitate data visualization, all values will be transformed into their absolute values and rounded to two decimal places, keeping in line with the format for currency.</span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a><span class="co"># convert all values *amount* to absolute values</span></span>
<span id="cb36-193"><a href="#cb36-193" aria-hidden="true" tabindex="-1"></a>fin_journal<span class="sc">$</span>amount <span class="ot">&lt;-</span> <span class="fu">abs</span>(fin_journal<span class="sc">$</span>amount)</span>
<span id="cb36-194"><a href="#cb36-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a><span class="co"># round all values to 2 decimal places</span></span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a>fin_journal<span class="sc">$</span>amount <span class="ot">&lt;-</span> <span class="fu">round</span>(fin_journal<span class="sc">$</span>amount, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3.5 Summation of *category* amounts</span></span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-201"><a href="#cb36-201" aria-hidden="true" tabindex="-1"></a>Since there are several transactions of the same category for each participant within a given month, we will employ the <span class="in">`group_by()`</span> and <span class="in">`summarise()`</span> functions to combine all transactions of the same category by adding them up.</span>
<span id="cb36-202"><a href="#cb36-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participantId, yearmon, category) <span class="sc">%&gt;%</span> </span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">amount =</span> <span class="fu">sum</span>(amount))</span>
<span id="cb36-209"><a href="#cb36-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-210"><a href="#cb36-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-211"><a href="#cb36-211" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3.6 Pivoting *category* column in *fin_journal*</span></span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a>The pivot_wider() function is used to generate separate columns for each transaction category.</span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a>In addition, any missing 'NaN' values are substituted with 0 to indicate that the participant had no transactions of that specific category in that particular month and year.</span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivoting the category column</span></span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> category,</span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> amount) <span class="sc">%&gt;%</span></span>
<span id="cb36-225"><a href="#cb36-225" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-226"><a href="#cb36-226" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill missing values with 0</span></span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">replace</span>(., <span class="fu">is.na</span>(.), <span class="dv">0</span>))</span>
<span id="cb36-228"><a href="#cb36-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-229"><a href="#cb36-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3.7 Creating new variables *total_expenses*, *total_earnings* and *total_savings*</span></span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a>fin_journal <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb36-236"><a href="#cb36-236" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-237"><a href="#cb36-237" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create new column for total expenses</span></span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_expenses =</span> <span class="fu">sum</span>(Education, Food, Recreation, Shelter)) <span class="sc">%&gt;%</span></span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-240"><a href="#cb36-240" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create new column for total earnings</span></span>
<span id="cb36-241"><a href="#cb36-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_earnings =</span> <span class="fu">sum</span>(Wage, RentAdjustment)) <span class="sc">%&gt;%</span>  </span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create new column for total earnings</span></span>
<span id="cb36-244"><a href="#cb36-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_savings =</span> (total_earnings <span class="sc">-</span> total_expenses))</span>
<span id="cb36-245"><a href="#cb36-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3.8 Displaying of final cleaned data sets</span></span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`kable()`</span> function of the <span class="in">`knitr`</span> package, the final cleaned data sets are displayed as follows:</span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-253"><a href="#cb36-253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(participants), <span class="at">align =</span> <span class="st">"c"</span>)</span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-259"><a href="#cb36-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-260"><a href="#cb36-260" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(fin_journal), <span class="at">align =</span> <span class="st">"c"</span>)</span>
<span id="cb36-261"><a href="#cb36-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-262"><a href="#cb36-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-263"><a href="#cb36-263" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4 Data Analysis and Visualization</span></span>
<span id="cb36-264"><a href="#cb36-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-265"><a href="#cb36-265" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1 Exploratory Data Analysis - Demographics</span></span>
<span id="cb36-266"><a href="#cb36-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-267"><a href="#cb36-267" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1.1 Distribution of participants by age</span></span>
<span id="cb36-268"><a href="#cb36-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-271"><a href="#cb36-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-272"><a href="#cb36-272" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">x =</span> <span class="sc">~</span>age, <span class="at">type =</span> <span class="st">"histogram"</span>, <span class="at">nbinsx =</span> <span class="dv">10</span>)</span>
<span id="cb36-273"><a href="#cb36-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-274"><a href="#cb36-274" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> age <span class="sc">%&gt;%</span> </span>
<span id="cb36-275"><a href="#cb36-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Distribution of participants' age"</span>,</span>
<span id="cb36-276"><a href="#cb36-276" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Age"</span>,</span>
<span id="cb36-277"><a href="#cb36-277" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zeroline =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-278"><a href="#cb36-278" aria-hidden="true" tabindex="-1"></a>                      <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">65</span>)),</span>
<span id="cb36-279"><a href="#cb36-279" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Count"</span>))</span>
<span id="cb36-280"><a href="#cb36-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-281"><a href="#cb36-281" aria-hidden="true" tabindex="-1"></a>age</span>
<span id="cb36-282"><a href="#cb36-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-283"><a href="#cb36-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-284"><a href="#cb36-284" aria-hidden="true" tabindex="-1"></a>**Insights:**</span>
<span id="cb36-285"><a href="#cb36-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-286"><a href="#cb36-286" aria-hidden="true" tabindex="-1"></a>There is a relatively even distribution of participants' ages between 20-59 years old, with the smallest number of participants being those who are 60 years old and above (23 participants) and those aged 15-19 (48 participants). The age group with the highest number of participants is the 30-34 age range, which has 130 participants.</span>
<span id="cb36-287"><a href="#cb36-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-288"><a href="#cb36-288" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1.2 Distribution of participants'</span></span>
<span id="cb36-289"><a href="#cb36-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-290"><a href="#cb36-290" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb36-291"><a href="#cb36-291" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interest groups by age</span></span>
<span id="cb36-292"><a href="#cb36-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-293"><a href="#cb36-293" aria-hidden="true" tabindex="-1"></a>The code</span>
<span id="cb36-294"><a href="#cb36-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-297"><a href="#cb36-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-298"><a href="#cb36-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-299"><a href="#cb36-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb36-300"><a href="#cb36-300" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(participants, </span>
<span id="cb36-301"><a href="#cb36-301" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb36-302"><a href="#cb36-302" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> interestGroup)) <span class="sc">+</span></span>
<span id="cb36-303"><a href="#cb36-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb36-304"><a href="#cb36-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">3</span>,</span>
<span id="cb36-305"><a href="#cb36-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb36-306"><a href="#cb36-306" aria-hidden="true" tabindex="-1"></a>    <span class="at">bandwidth =</span> <span class="fl">3.4</span>,</span>
<span id="cb36-307"><a href="#cb36-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"#7097BB"</span>, <span class="fl">0.5</span>),</span>
<span id="cb36-308"><a href="#cb36-308" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb36-309"><a href="#cb36-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb36-310"><a href="#cb36-310" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age"</span>,</span>
<span id="cb36-311"><a href="#cb36-311" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb36-312"><a href="#cb36-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">2.6</span>))) <span class="sc">+</span></span>
<span id="cb36-313"><a href="#cb36-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>()</span>
<span id="cb36-314"><a href="#cb36-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-315"><a href="#cb36-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-316"><a href="#cb36-316" aria-hidden="true" tabindex="-1"></a>The plot</span>
<span id="cb36-317"><a href="#cb36-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-320"><a href="#cb36-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-321"><a href="#cb36-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb36-322"><a href="#cb36-322" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(participants, </span>
<span id="cb36-323"><a href="#cb36-323" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb36-324"><a href="#cb36-324" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> interestGroup)) <span class="sc">+</span></span>
<span id="cb36-325"><a href="#cb36-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb36-326"><a href="#cb36-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">3</span>,</span>
<span id="cb36-327"><a href="#cb36-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb36-328"><a href="#cb36-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">bandwidth =</span> <span class="fl">3.4</span>,</span>
<span id="cb36-329"><a href="#cb36-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"#7097BB"</span>, <span class="fl">0.5</span>),</span>
<span id="cb36-330"><a href="#cb36-330" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb36-331"><a href="#cb36-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb36-332"><a href="#cb36-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age"</span>,</span>
<span id="cb36-333"><a href="#cb36-333" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb36-334"><a href="#cb36-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">2.6</span>))) <span class="sc">+</span></span>
<span id="cb36-335"><a href="#cb36-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>()</span>
<span id="cb36-336"><a href="#cb36-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-337"><a href="#cb36-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-338"><a href="#cb36-338" aria-hidden="true" tabindex="-1"></a><span class="fu">## Education level by age</span></span>
<span id="cb36-339"><a href="#cb36-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-340"><a href="#cb36-340" aria-hidden="true" tabindex="-1"></a>The code</span>
<span id="cb36-341"><a href="#cb36-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-344"><a href="#cb36-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-345"><a href="#cb36-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-346"><a href="#cb36-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb36-347"><a href="#cb36-347" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(participants, </span>
<span id="cb36-348"><a href="#cb36-348" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb36-349"><a href="#cb36-349" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> educationLevel)) <span class="sc">+</span></span>
<span id="cb36-350"><a href="#cb36-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb36-351"><a href="#cb36-351" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">3</span>,</span>
<span id="cb36-352"><a href="#cb36-352" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb36-353"><a href="#cb36-353" aria-hidden="true" tabindex="-1"></a>    <span class="at">bandwidth =</span> <span class="fl">3.4</span>,</span>
<span id="cb36-354"><a href="#cb36-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"#800020"</span>, <span class="fl">0.5</span>),</span>
<span id="cb36-355"><a href="#cb36-355" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb36-356"><a href="#cb36-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb36-357"><a href="#cb36-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age"</span>,</span>
<span id="cb36-358"><a href="#cb36-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb36-359"><a href="#cb36-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">2.6</span>))) <span class="sc">+</span></span>
<span id="cb36-360"><a href="#cb36-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>()</span>
<span id="cb36-361"><a href="#cb36-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-362"><a href="#cb36-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-363"><a href="#cb36-363" aria-hidden="true" tabindex="-1"></a>The plot</span>
<span id="cb36-364"><a href="#cb36-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-367"><a href="#cb36-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-368"><a href="#cb36-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb36-369"><a href="#cb36-369" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(participants, </span>
<span id="cb36-370"><a href="#cb36-370" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb36-371"><a href="#cb36-371" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> educationLevel)) <span class="sc">+</span></span>
<span id="cb36-372"><a href="#cb36-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb36-373"><a href="#cb36-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">3</span>,</span>
<span id="cb36-374"><a href="#cb36-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb36-375"><a href="#cb36-375" aria-hidden="true" tabindex="-1"></a>    <span class="at">bandwidth =</span> <span class="fl">3.4</span>,</span>
<span id="cb36-376"><a href="#cb36-376" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"#800020"</span>, <span class="fl">0.5</span>),</span>
<span id="cb36-377"><a href="#cb36-377" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb36-378"><a href="#cb36-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb36-379"><a href="#cb36-379" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age"</span>,</span>
<span id="cb36-380"><a href="#cb36-380" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb36-381"><a href="#cb36-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">2.6</span>))) <span class="sc">+</span></span>
<span id="cb36-382"><a href="#cb36-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>()</span>
<span id="cb36-383"><a href="#cb36-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-384"><a href="#cb36-384" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-385"><a href="#cb36-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-386"><a href="#cb36-386" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1.3 Proportion of participants</span></span>
<span id="cb36-387"><a href="#cb36-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-388"><a href="#cb36-388" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb36-389"><a href="#cb36-389" aria-hidden="true" tabindex="-1"></a><span class="fu">## By education level</span></span>
<span id="cb36-390"><a href="#cb36-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-391"><a href="#cb36-391" aria-hidden="true" tabindex="-1"></a>The code</span>
<span id="cb36-392"><a href="#cb36-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-395"><a href="#cb36-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-396"><a href="#cb36-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-397"><a href="#cb36-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb36-398"><a href="#cb36-398" aria-hidden="true" tabindex="-1"></a>edu_count <span class="ot">=</span> <span class="fu">count</span>(participants, educationLevel)</span>
<span id="cb36-399"><a href="#cb36-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-400"><a href="#cb36-400" aria-hidden="true" tabindex="-1"></a>edu_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>edu_count<span class="sc">$</span>educationLevel, <span class="at">values =</span> <span class="sc">~</span>edu_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb36-401"><a href="#cb36-401" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb36-402"><a href="#cb36-402" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb36-403"><a href="#cb36-403" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb36-404"><a href="#cb36-404" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(edu_count<span class="sc">$</span>n, <span class="st">"participants"</span>),</span>
<span id="cb36-405"><a href="#cb36-405" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-406"><a href="#cb36-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants by education level"</span>)</span>
<span id="cb36-407"><a href="#cb36-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-408"><a href="#cb36-408" aria-hidden="true" tabindex="-1"></a>edu_prop</span>
<span id="cb36-409"><a href="#cb36-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-410"><a href="#cb36-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-411"><a href="#cb36-411" aria-hidden="true" tabindex="-1"></a>The plot</span>
<span id="cb36-412"><a href="#cb36-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-415"><a href="#cb36-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-416"><a href="#cb36-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb36-417"><a href="#cb36-417" aria-hidden="true" tabindex="-1"></a>edu_count <span class="ot">=</span> <span class="fu">count</span>(participants, educationLevel)</span>
<span id="cb36-418"><a href="#cb36-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-419"><a href="#cb36-419" aria-hidden="true" tabindex="-1"></a>edu_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>edu_count<span class="sc">$</span>educationLevel, <span class="at">values =</span> <span class="sc">~</span>edu_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb36-420"><a href="#cb36-420" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb36-421"><a href="#cb36-421" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb36-422"><a href="#cb36-422" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb36-423"><a href="#cb36-423" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(edu_count<span class="sc">$</span>n, <span class="st">"participants"</span>),</span>
<span id="cb36-424"><a href="#cb36-424" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-425"><a href="#cb36-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants by education level"</span>)</span>
<span id="cb36-426"><a href="#cb36-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-427"><a href="#cb36-427" aria-hidden="true" tabindex="-1"></a>edu_prop</span>
<span id="cb36-428"><a href="#cb36-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-429"><a href="#cb36-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-430"><a href="#cb36-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## By household size</span></span>
<span id="cb36-431"><a href="#cb36-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-432"><a href="#cb36-432" aria-hidden="true" tabindex="-1"></a>The code</span>
<span id="cb36-433"><a href="#cb36-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-436"><a href="#cb36-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-437"><a href="#cb36-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-438"><a href="#cb36-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb36-439"><a href="#cb36-439" aria-hidden="true" tabindex="-1"></a>hhld_count <span class="ot">=</span> <span class="fu">count</span>(participants, householdSize)</span>
<span id="cb36-440"><a href="#cb36-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-441"><a href="#cb36-441" aria-hidden="true" tabindex="-1"></a>hhld_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>hhld_count<span class="sc">$</span>householdSize, <span class="at">values =</span> <span class="sc">~</span>hhld_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb36-442"><a href="#cb36-442" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb36-443"><a href="#cb36-443" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb36-444"><a href="#cb36-444" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb36-445"><a href="#cb36-445" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Number of households ="</span>, hhld_count<span class="sc">$</span>n),</span>
<span id="cb36-446"><a href="#cb36-446" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-447"><a href="#cb36-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants by household size"</span>)</span>
<span id="cb36-448"><a href="#cb36-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-449"><a href="#cb36-449" aria-hidden="true" tabindex="-1"></a>hhld_prop</span>
<span id="cb36-450"><a href="#cb36-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-451"><a href="#cb36-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-452"><a href="#cb36-452" aria-hidden="true" tabindex="-1"></a>The plot</span>
<span id="cb36-453"><a href="#cb36-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-456"><a href="#cb36-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-457"><a href="#cb36-457" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb36-458"><a href="#cb36-458" aria-hidden="true" tabindex="-1"></a>hhld_count <span class="ot">=</span> <span class="fu">count</span>(participants, householdSize)</span>
<span id="cb36-459"><a href="#cb36-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-460"><a href="#cb36-460" aria-hidden="true" tabindex="-1"></a>hhld_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>hhld_count<span class="sc">$</span>householdSize, <span class="at">values =</span> <span class="sc">~</span>hhld_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb36-461"><a href="#cb36-461" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb36-462"><a href="#cb36-462" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb36-463"><a href="#cb36-463" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb36-464"><a href="#cb36-464" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Number of households ="</span>, hhld_count<span class="sc">$</span>n),</span>
<span id="cb36-465"><a href="#cb36-465" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-466"><a href="#cb36-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants by household size"</span>)</span>
<span id="cb36-467"><a href="#cb36-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-468"><a href="#cb36-468" aria-hidden="true" tabindex="-1"></a>hhld_prop</span>
<span id="cb36-469"><a href="#cb36-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-470"><a href="#cb36-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-471"><a href="#cb36-471" aria-hidden="true" tabindex="-1"></a><span class="fu">## Have Kids</span></span>
<span id="cb36-472"><a href="#cb36-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-473"><a href="#cb36-473" aria-hidden="true" tabindex="-1"></a>The code</span>
<span id="cb36-474"><a href="#cb36-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-477"><a href="#cb36-477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-478"><a href="#cb36-478" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-479"><a href="#cb36-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb36-480"><a href="#cb36-480" aria-hidden="true" tabindex="-1"></a>kids_count <span class="ot">=</span> <span class="fu">count</span>(participants, haveKids)</span>
<span id="cb36-481"><a href="#cb36-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-482"><a href="#cb36-482" aria-hidden="true" tabindex="-1"></a>kids_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>kids_count<span class="sc">$</span>haveKids, <span class="at">values =</span> <span class="sc">~</span>kids_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb36-483"><a href="#cb36-483" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb36-484"><a href="#cb36-484" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb36-485"><a href="#cb36-485" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb36-486"><a href="#cb36-486" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Number of households with kids ="</span>, kids_count<span class="sc">$</span>n),</span>
<span id="cb36-487"><a href="#cb36-487" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-488"><a href="#cb36-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants whose households have kids"</span>)</span>
<span id="cb36-489"><a href="#cb36-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-490"><a href="#cb36-490" aria-hidden="true" tabindex="-1"></a>kids_prop</span>
<span id="cb36-491"><a href="#cb36-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-492"><a href="#cb36-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-493"><a href="#cb36-493" aria-hidden="true" tabindex="-1"></a>The plot</span>
<span id="cb36-494"><a href="#cb36-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-497"><a href="#cb36-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-498"><a href="#cb36-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb36-499"><a href="#cb36-499" aria-hidden="true" tabindex="-1"></a>kids_count <span class="ot">=</span> <span class="fu">count</span>(participants, haveKids)</span>
<span id="cb36-500"><a href="#cb36-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-501"><a href="#cb36-501" aria-hidden="true" tabindex="-1"></a>kids_prop <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(participants, <span class="at">labels =</span> <span class="sc">~</span>kids_count<span class="sc">$</span>haveKids, <span class="at">values =</span> <span class="sc">~</span>kids_count<span class="sc">$</span>n, <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb36-502"><a href="#cb36-502" aria-hidden="true" tabindex="-1"></a>        <span class="at">textposition =</span> <span class="st">"inside"</span>,</span>
<span id="cb36-503"><a href="#cb36-503" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb36-504"><a href="#cb36-504" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb36-505"><a href="#cb36-505" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Number of households with kids ="</span>, kids_count<span class="sc">$</span>n),</span>
<span id="cb36-506"><a href="#cb36-506" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-507"><a href="#cb36-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Proportion of participants whose households have kids"</span>)</span>
<span id="cb36-508"><a href="#cb36-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-509"><a href="#cb36-509" aria-hidden="true" tabindex="-1"></a>kids_prop</span>
<span id="cb36-510"><a href="#cb36-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-511"><a href="#cb36-511" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-512"><a href="#cb36-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-513"><a href="#cb36-513" aria-hidden="true" tabindex="-1"></a>**Insights:**</span>
<span id="cb36-514"><a href="#cb36-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-515"><a href="#cb36-515" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Most participants in the city of Engagement are highly educated, with only 8.31% of the participants surveyed having a low level of education.</span>
<span id="cb36-516"><a href="#cb36-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-517"><a href="#cb36-517" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Household sizes of the participants are relatively small, with more than 2/3 of the participants' household sizes being 2 or less.</span>
<span id="cb36-518"><a href="#cb36-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-519"><a href="#cb36-519" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>This could be attributed to the fact that more than 2/3 of households (70.2%) do not have children.</span>
<span id="cb36-520"><a href="#cb36-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-521"><a href="#cb36-521" aria-hidden="true" tabindex="-1"></a>These insights lead us to the next question: does having a high level of education result in fewer participants having children?</span>
<span id="cb36-522"><a href="#cb36-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-523"><a href="#cb36-523" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2 Confirmatory Data Analysis - Demographics</span></span>
<span id="cb36-524"><a href="#cb36-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-525"><a href="#cb36-525" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2.1 Is education level associated with having kids?</span></span>
<span id="cb36-526"><a href="#cb36-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-527"><a href="#cb36-527" aria-hidden="true" tabindex="-1"></a>In order to find out if there really is an association between education level and having kids, the following hypotheses will be tested at 95% confidence level:</span>
<span id="cb36-528"><a href="#cb36-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-529"><a href="#cb36-529" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb36-530"><a href="#cb36-530" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H~0~: There is no significant association between education level and having kids.</span>
<span id="cb36-531"><a href="#cb36-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-532"><a href="#cb36-532" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H~1~: The association between education level and having kids is statistically significant.</span>
<span id="cb36-533"><a href="#cb36-533" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-534"><a href="#cb36-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-537"><a href="#cb36-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-538"><a href="#cb36-538" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-539"><a href="#cb36-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-540"><a href="#cb36-540" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a plot</span></span>
<span id="cb36-541"><a href="#cb36-541" aria-hidden="true" tabindex="-1"></a>have_kids <span class="ot">&lt;-</span> <span class="fu">ggbarstats</span>(</span>
<span id="cb36-542"><a href="#cb36-542" aria-hidden="true" tabindex="-1"></a>  participants, </span>
<span id="cb36-543"><a href="#cb36-543" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> haveKids, </span>
<span id="cb36-544"><a href="#cb36-544" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> educationLevel,</span>
<span id="cb36-545"><a href="#cb36-545" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Education level"</span>,</span>
<span id="cb36-546"><a href="#cb36-546" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb36-547"><a href="#cb36-547" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>,</span>
<span id="cb36-548"><a href="#cb36-548" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Is there an association between education level and having kids?"</span>)</span>
<span id="cb36-549"><a href="#cb36-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-550"><a href="#cb36-550" aria-hidden="true" tabindex="-1"></a><span class="co"># looking at the plot</span></span>
<span id="cb36-551"><a href="#cb36-551" aria-hidden="true" tabindex="-1"></a>have_kids</span>
<span id="cb36-552"><a href="#cb36-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-553"><a href="#cb36-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-554"><a href="#cb36-554" aria-hidden="true" tabindex="-1"></a>Based on the Pearson's chi-square test results, the p-value of 5.91e-03 is lower than the alpha value of 0.05. Thus, there is sufficient evidence to reject the null hypothesis and conclude that there is a statistically significant association between education level and households with kids.</span>
<span id="cb36-555"><a href="#cb36-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-556"><a href="#cb36-556" aria-hidden="true" tabindex="-1"></a>Visually as seen from the graph, we can observe that as education levels increase, the proportion of participants' households with kids decreases.</span>
<span id="cb36-557"><a href="#cb36-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-558"><a href="#cb36-558" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1.4 Does education level affect joviality?</span></span>
<span id="cb36-559"><a href="#cb36-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-560"><a href="#cb36-560" aria-hidden="true" tabindex="-1"></a>Are people with higher education levels happier, or is there no difference in joviality regardless of education level? To find out, a one-way ANOVA test is done on the following hypotheses at a confidence level of 95%:</span>
<span id="cb36-561"><a href="#cb36-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-562"><a href="#cb36-562" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb36-563"><a href="#cb36-563" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H~0~: There is no difference among group means.</span>
<span id="cb36-564"><a href="#cb36-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-565"><a href="#cb36-565" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H~1~: There is a difference among group means.</span>
<span id="cb36-566"><a href="#cb36-566" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-567"><a href="#cb36-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-570"><a href="#cb36-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-571"><a href="#cb36-571" aria-hidden="true" tabindex="-1"></a>edu_jov <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb36-572"><a href="#cb36-572" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> participants,</span>
<span id="cb36-573"><a href="#cb36-573" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> educationLevel,</span>
<span id="cb36-574"><a href="#cb36-574" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> joviality,</span>
<span id="cb36-575"><a href="#cb36-575" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb36-576"><a href="#cb36-576" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean.ci =</span> <span class="cn">TRUE</span>, </span>
<span id="cb36-577"><a href="#cb36-577" aria-hidden="true" tabindex="-1"></a>  <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb36-578"><a href="#cb36-578" aria-hidden="true" tabindex="-1"></a>  <span class="at">pairwise.display =</span> <span class="st">"s"</span>,</span>
<span id="cb36-579"><a href="#cb36-579" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"fdr"</span>,</span>
<span id="cb36-580"><a href="#cb36-580" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-581"><a href="#cb36-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-582"><a href="#cb36-582" aria-hidden="true" tabindex="-1"></a>edu_jov</span>
<span id="cb36-583"><a href="#cb36-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-584"><a href="#cb36-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-585"><a href="#cb36-585" aria-hidden="true" tabindex="-1"></a>As the p-value of 0.70 is higher than the alpha value of 0.05, we accept the null hypothesis as there is sufficient evidence to conclude that the means among the different education levels are the same. Therefore, education level does not really affect joviality.</span>
<span id="cb36-586"><a href="#cb36-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-587"><a href="#cb36-587" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1.5 Is age correlated with joviality?</span></span>
<span id="cb36-588"><a href="#cb36-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-591"><a href="#cb36-591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-592"><a href="#cb36-592" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(</span>
<span id="cb36-593"><a href="#cb36-593" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> participants,</span>
<span id="cb36-594"><a href="#cb36-594" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> age,</span>
<span id="cb36-595"><a href="#cb36-595" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> joviality, </span>
<span id="cb36-596"><a href="#cb36-596" aria-hidden="true" tabindex="-1"></a>  <span class="at">bins =</span> <span class="dv">20</span>)</span>
<span id="cb36-597"><a href="#cb36-597" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-598"><a href="#cb36-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-599"><a href="#cb36-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-600"><a href="#cb36-600" aria-hidden="true" tabindex="-1"></a>**Insights:**</span>
<span id="cb36-601"><a href="#cb36-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-602"><a href="#cb36-602" aria-hidden="true" tabindex="-1"></a>The data points deviate greatly from the best fit line, indicating that there is no correlation between age and joviality.</span>
<span id="cb36-603"><a href="#cb36-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-604"><a href="#cb36-604" aria-hidden="true" tabindex="-1"></a><span class="fu">### Does spending more on recreation make people happier?</span></span>
<span id="cb36-605"><a href="#cb36-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-606"><a href="#cb36-606" aria-hidden="true" tabindex="-1"></a><span class="fu">### Does earning more make people happier?</span></span>
<span id="cb36-607"><a href="#cb36-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-608"><a href="#cb36-608" aria-hidden="true" tabindex="-1"></a><span class="fu">### spending patterns</span></span>
<span id="cb36-609"><a href="#cb36-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-610"><a href="#cb36-610" aria-hidden="true" tabindex="-1"></a><span class="fu">### total spending over the year and total earnings over the year animated plot</span></span>
<span id="cb36-611"><a href="#cb36-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-612"><a href="#cb36-612" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2 Exploratory Data Analysis - Financial</span></span>
<span id="cb36-613"><a href="#cb36-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-614"><a href="#cb36-614" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2.1 What do the participants of the City of Engagement spend the most on?</span></span>
<span id="cb36-615"><a href="#cb36-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-618"><a href="#cb36-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-619"><a href="#cb36-619" aria-hidden="true" tabindex="-1"></a>fin_long <span class="ot">&lt;-</span> fin_journal <span class="sc">%&gt;%</span></span>
<span id="cb36-620"><a href="#cb36-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Education<span class="sc">:</span>Shelter, <span class="at">names_to =</span> <span class="st">"Category"</span>, <span class="at">values_to =</span> <span class="st">"Amount"</span>)</span>
<span id="cb36-621"><a href="#cb36-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-622"><a href="#cb36-622" aria-hidden="true" tabindex="-1"></a>total_spent <span class="ot">&lt;-</span> fin_long <span class="sc">%&gt;%</span> </span>
<span id="cb36-623"><a href="#cb36-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb36-624"><a href="#cb36-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total =</span> <span class="fu">sum</span>(Amount))</span>
<span id="cb36-625"><a href="#cb36-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-626"><a href="#cb36-626" aria-hidden="true" tabindex="-1"></a>total_fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb36-627"><a href="#cb36-627" aria-hidden="true" tabindex="-1"></a>  total_spent, </span>
<span id="cb36-628"><a href="#cb36-628" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>Category, </span>
<span id="cb36-629"><a href="#cb36-629" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Total,</span>
<span id="cb36-630"><a href="#cb36-630" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span>Category,</span>
<span id="cb36-631"><a href="#cb36-631" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"bar"</span>,</span>
<span id="cb36-632"><a href="#cb36-632" aria-hidden="true" tabindex="-1"></a>  <span class="at">textposition =</span> <span class="st">"none"</span>,</span>
<span id="cb36-633"><a href="#cb36-633" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb36-634"><a href="#cb36-634" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(total_spent<span class="sc">$</span>Total, <span class="st">" ("</span>, scales<span class="sc">::</span><span class="fu">percent</span>(total_spent<span class="sc">$</span>Total<span class="sc">/</span><span class="fu">sum</span>(total_spent<span class="sc">$</span>Total)), <span class="st">")"</span>),</span>
<span id="cb36-635"><a href="#cb36-635" aria-hidden="true" tabindex="-1"></a>  <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-636"><a href="#cb36-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"What do the participants spend the most on?"</span>,</span>
<span id="cb36-637"><a href="#cb36-637" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Category"</span>)),</span>
<span id="cb36-638"><a href="#cb36-638" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Total Amount Spent"</span>)))</span>
<span id="cb36-639"><a href="#cb36-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-640"><a href="#cb36-640" aria-hidden="true" tabindex="-1"></a>total_fig</span>
<span id="cb36-641"><a href="#cb36-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-642"><a href="#cb36-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-643"><a href="#cb36-643" aria-hidden="true" tabindex="-1"></a>**Insights:**</span>
<span id="cb36-644"><a href="#cb36-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-645"><a href="#cb36-645" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Most of the participants' expenditure is due to Shelter, which accounts for 45.9% of the total spending.</span>
<span id="cb36-646"><a href="#cb36-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-647"><a href="#cb36-647" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The category that participants spent the least on is Education, accounting for only 0.9% of the total spending.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>